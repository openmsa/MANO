#
#
#
#
tosca_definitions_version: tosca_simple_yaml_1_0
description: >
  Sample NSD for integration testing.

imports:
  - etsi_nfv_sol001_nsd_types.yaml
  - fix_ubiqube.yaml


topology_template:
  node_templates:
    ns01:
      type: tosca.nodes.nfv.NS
      properties:
        descriptor_id: fb4f8f06-f4b0-4d80-8cda-cd95cf018972
        designer: ovi@ubiqube.com
        version: 0.0.1
        name: First NSD.
        invariant_id: 65f6fbed-654b-4d68-b730-5d8d72a8b865
        flavour_id: flavor01
        ns_profile: # tosca.datatypes.nfv.NsProfile
          ns_instantiation_level: demo
          min_number_of_instances: 1
          max_number_of_instances: 1
          flavour_id: flavor02
      requirements:
        #- virtual_link: # tosca.nodes.nfv.NsVirtualLink


    ubiqube:
      type: tosca.nodes.nfv.NsTopology
      properties:
        flavour_id: flavor01
        vnfd_invariant:
          - dcd11fbf-c767-41eb-abc9-cec35dd95bca
        nested_nsd_invariant:
          - 3b91b199-73a6-439d-b8f1-fb1fa236815e


    vl01:
      type: tosca.nodes.nfv.NsVirtualLink
      properties:
        description: First VL
        vl_profile: # tosca.datatypes.nfv.NsVlProfile
          max_bitrate_requirements:
            root: 1000
            leaf: 5000
          min_bitrate_requirements:
            root: 200
            leaf: 400
          qos: # tosca.datatypes.nfv.NsVirtualLinkQos
            priority: 0
          service_availability: # tosca.datatypes.nfv.ServiceAvailability
            level: level1
        connectivity_type: # tosca.datatypes.nfv.ConnectivityType
          layer_protocols:
            - ipv4
          flow_pattern: mesh
        test_access:
          - test
  
  
  
    sap01:
      type: tosca.nodes.nfv.Sap
      properties:
        layer_protocols:
          - ipv4
        role: root
        description: Description.
        protocol: # tosca.datatypes.nfv.CpProtocolData
          - associated_layer_protocol: mpls
            address_data: # tosca.datatypes.nfv.AddressData
              - address_type: ip_address
                l2_address_data: # tosca.datatypes.nfv.L2AddressData
                  mac_address_assignment: true
                l3_address_data: # tosca.datatypes.nfv.L3AddressData
                  ip_address_assignment: true
                  floating_ip_activated: true
                  ip_address_type: ipv4
                  number_of_ip_address: 10
        trunk_mode: false
      requirements:
        # - external_virtual_link:
        # - internal_virtual_link: # Must be defined

    nfp_position_element:
      type: tosca.nodes.nfv.NfpPositionElement
      capabilities:
        forwarding: # tosca.capabilities.nfv.Forwarding
      requirements:
        - profile_element: forward_to


    nfp_position:
      type: tosca.nodes.nfv.NfpPosition
      properties:
        forwarding_behaviour: all
      capabilities:
        forwarding: # tosca.capabilities.nfv.Forwarding
      requirements:
        - element: # tosca.nodes.nfv.NfpPositionElement


    nfp:
      type: tosca.nodes.nfv.NFP
      requirements:
        - nfp_position: # tosca.nodes.nfv.NfpPosition

    forwarding:
      type: tosca.nodes.nfv.Forwarding
      capabilities:
        virtual_linkable: # tosca.capabilities.nfv.VirtualLinkable
        forwarding: # tosca.capabilities.nfv.Forwarding
      requirements:
        - virtual_link:


policies:
  affinity:
    type: tosca.policies.nfv.AffinityRule
    properties:
      scope: nfvi_pop
    targets: 
      - vl01


  anti_affinity:
    type: tosca.policies.nfv.AntiAffinityRule
    properties:
      scope: zone
    targets:
      - vl01


  security_group01:
    type: tosca.policies.nfv.SecurityGroupRule
    properties:
      description: test SG
      direction: egress
      ether_type: ipv4
      protocol: tcp
      port_range_min: 0
      port_range_max: 65535
    targets:
      - sap01


  nfp_rule:
    type: tosca.policies.nfv.NfpRule
    properties:
      ether_destination_address:
      ether_source_address:
      ether_type: ipv4
      vlan_tag:
        - srt
        - str2
      protocol:
      dscp:
      source_port_range: 0 - 22
      source_ip_address_prefix:
      destination_ip_address_prefix:
      extended_criteria: # tosca.datatypes.nfv.Mask
        - starting_point: 1
          length: 7
          value: string
      targets: # tosca.nodes.nfv.NFP


group_types:
  vnfgg:
    type: tosca.groups.nfv.VNFFG
    properties:
      description: descr
    members:
      - one
      - two


